<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">

<!--
/***********************************************************************
 * 
 * user/register/index.html
 * 
 * @Copyright (c) 2016 boluozhai.com
 * @License MIT License
 * @Author xukun<xukun17@sina.com>
 * 
 */
-->

<head>

<meta charset='utf-8' />
<meta name="viewport" content="width=device-width, initial-scale=1" />

<title class='i18n' i18n='register'>注册</title>

<link href="./lib/import/bootstrap/css/bootstrap.min.css"
	rel="stylesheet" type="text/css" />

<link href="./lib/css/signin.css" rel="stylesheet" type="text/css" />


<style type="text/css">
.to-reg {
	margin-top: 100px;
	text-align: center;
}
</style>

</head>
<body>


	<div class="container">

		<form class="form-signin" role="form">
			<div>
				<h2 class="form-signin-heading i18n " i18n='register_account'>注册个帐号</h2>
			</div>
			<div>
				<input id='edit-email' type="email" class="form-control i18n "
					i18n-placeholder='email_address' placeholder="邮箱地址" required
					autofocus />
			</div>
			<div>
				<input id='edit-passwd' type="password" class="form-control i18n"
					i18n-placeholder='password' placeholder="密码" required />
			</div>
			<div>
				<input id='edit-passwd-2' type="password"
					class="form-control  i18n " i18n-placeholder='password_again'
					placeholder="密码，再来一次" required />
			</div>
			<div>
				<button id='btn-ok' class="btn btn-lg btn-primary btn-block i18n "
					type="button" i18n='ok'>确定</button>
			</div>
		</form>


		<div class='to-reg'>
			<a href='./login' class='i18n' i18n='i_have_a_account'>我有现成的帐号！</a>
		</div>

	</div>


	<script src="./lib/import/jquery/jquery.min.js"></script>
	<script src="./lib/import/bootstrap/js/bootstrap.min.js"></script>

	<script src="./lib/import/snowflake/core.js"></script>
	<script src="./lib/import/snowflake/context.js"></script>
	<script src="./lib/import/snowflake/event.js"></script>
	<script src="./lib/import/snowflake/rest.js"></script>
	<script src="./lib/import/snowflake/sha1.js"></script>

	<script src="./lib/export/h2o/js/widget.js"></script>
	<script src="./lib/export/h2o/js/h2o-rest-api.js"></script>
	<script src="./lib/export/h2o/js/auth.js"></script>

	<script src="./lib/js/config/base.js"></script>
	<script src="./lib/js/config/i18n-base.js"></script>
	<script src="./lib/js/config/final.js"></script>

	<script src="./this.js"></script>
	<script src="./i18n.js?service=active-www"></script>


	<script type="text/javascript">
		var AuthCtrl = com.boluozhai.h2o.webui.auth.AuthCtrl;

		$(document).ready(function() {

			var context = Snowflake.getContext();
			var ctrl = new AuthCtrl(context);

			$('#btn-ok').click(function() {
				onClickOK(ctrl);
			});

			set_ui_mode(false);
			init_4_debug();

		});

		function init_4_debug() {

			$('#edit-email').val('test@blz.com');
			$('#edit-passwd').val('1234');
			$('#edit-passwd-2').val('1234');

		}

		function set_ui_mode(working) {
		}

		function onClickOK(ctrl) {

			var email = $('#edit-email').val();
			var passwd = $('#edit-passwd').val();
			var passwd2 = $('#edit-passwd-2').val();

			if (passwd != passwd2) {
				alert('2 passwds not match.');
				return;
			}

			set_ui_mode(true);

			var task = ctrl.register();
			task.email(email);
			task.password(passwd);

			task.execute(function() {

				if (task.success()) {
					onLoginOK(task);
				} else {
					onLoginError(task);
				}

				set_ui_mode(false);

			});

		}

		function onLoginError(task) {
			var msg = task.message();
			alert('Error: ' + msg);
		}

		function onLoginOK(task) {
			alert('OK');
		}
	</script>

</body>
</html>