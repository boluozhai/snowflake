<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">

<!--
/***********************************************************************
 * 
 * language.html
 * 
 * @Copyright (c) 2016 boluozhai.com
 * @License MIT License
 * @Author xukun<xukun17@sina.com>
 * 
 */
-->

<head>

<meta charset='utf-8' />
<title>Language</title>

<link href="./lib/import/bootstrap/css/bootstrap.min.css"
	rel="stylesheet" type="text/css" />

</head>
<body>

	<div class='container'>


		<div id='page-head'></div>

		<!-- for debug -->


		<h1 class='i18n' i18n='language'>Language</h1>


		<div class="row">

			<div class="col-lg-6">
				<div class="input-group">
					<input type="text" class=" input-lang-name form-control"> <span
						class="input-group-btn">
						<button class="btn btn-default  i18n btn-setup " i18n='setup'
							type="button">设置</button>
					</span>
				</div>
			</div>

		</div>

		<div>
			<pre class='i18n-out'></pre>
		</div>

	</div>

	<script src="./lib/import/jquery/jquery.min.js"></script>
	<script src="./lib/import/bootstrap/js/bootstrap.min.js"></script>


	<script src="./lib/import/snowflake/core.js"></script>
	<script src="./lib/import/snowflake/context.js"></script>
	<script src="./lib/import/snowflake/rest.js"></script>
	<script src="./lib/import/snowflake/event.js"></script>
	<script src="./lib/import/snowflake/listview.js"></script>


	<script src="./lib/export/h2o/js/widget.js"></script>
	<script src="./lib/export/h2o/js/h2o-rest-api.js"></script>
	<script src="./lib/export/h2o/js/session.js"></script>
	<script src="./lib/export/h2o/js/viewport.js"></script>
	<script src="./lib/export/h2o/js/head.js"></script>


	<script src="./lib/js/config/base.js"></script>
	<script src="./lib/js/config/i18n-base.js"></script>
	<script src="./lib/js/config/final.js"></script>

	<script src="./lib/js/i18n/zh_CN.js"></script>
	<script src="./lib/js/i18n/en_US.js"></script>
	<script src="./lib/js/i18n/default.js"></script>


	<script src="./lib/js/ui/language.html.js"></script>

	<script src="./current-session-info.js?service=active-www"></script>
	<script src="./this.js"></script>

	<script type="text/javascript">
		$(document).ready(function() {

			var LanguageHtml = com.boluozhai.h2o.html.LanguageHtml;

			var context = Snowflake.getContext();
			var ctrl = new LanguageHtml(context);
			ctrl.init();

			var input = $('.input-lang-name');
			input.val('zh_CN');
			$('.btn-setup').click(do_setup);

			// output i18n mapping
			var i18n = context.i18n();
			var js = i18n._word_table;
			var str = JSON.stringify(js, null, 4);
			$('.i18n-out').text('i18n = ' + str);

		});

		function do_setup() {

			var input = $('.input-lang-name');
			var lang = input.val();
			send(lang);

		}

		function send(lang) {
			var url = './i18n.js?service=active-www&language=' + lang;
			var xhr = new XMLHttpRequest();
			xhr.open('POST', url, true);
			xhr.onreadystatechange = function() {

				var state = xhr.readyState;
				if (state != 4) {
					return;
				}

				var status = xhr.status;
				if (status == 200) {
					alert('setup language as : ' + lang);
				} else {
					alert('Error: HTTP ' + status);
				}

			};
			xhr.send();
		}
	</script>

</body>
</html>