<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE beans PUBLIC "-//SPRING//DTD BEAN//EN" 
 "http://www.springframework.org/dtd/spring-beans-2.0.dtd" >
<beans>

	<bean id='com.boluozhai.snowflake.xgit.utils.CurrentLocation'
		class='com.boluozhai.snowflake.xgit.utils.DefaultCurrentLocation' />

	<bean id='com.boluozhai.snowflake.xgit.utils.RepositoryAgent'
		class='com.boluozhai.snowflake.xgit.utils.DefaultRepositoryAgent' />


	<!-- RM -->


	<bean id='com.boluozhai.snowflake.xgit.repository.RepositoryManager'
		class='com.boluozhai.snowflake.xgit.support.DefaultRepositoryManager'>

		<property name="drivers">
			<map>
				<entry key="file">
					<ref bean="xgit:driver:file" />
				</entry>
			</map>
			<map>
				<entry key="http">
					<ref bean="xgit:driver:http" />
				</entry>
			</map>
			<map>
				<entry key="https">
					<ref bean="xgit:driver:http" />
				</entry>
			</map>
		</property>

	</bean>


	<!-- drivers -->


	<bean id='xgit:driver:file'
		class='com.boluozhai.snowflake.xgit.vfs.support.FileRepositoryDriver'>
		<property name="profile">
			<ref bean='xgit:driver:file:profile' />
		</property>
	</bean>


	<bean id='xgit:driver:http'
		class='com.boluozhai.snowflake.xgit.http.support.HttpRepositoryDriver'>
		<property name="profile">
			<ref bean='xgit:driver:http:profile' />
		</property>
	</bean>


	<!-- profiles -->


	<bean id='xgit:driver:file:profile' class='com.boluozhai.snowflake.xgit.support.RepositoryProfile'>

		<property name="components">
			<!-- in Map<String,ComponentBuilderFactory> -->
			<map>
				<entry key='repository'>
					<bean
						class='com.boluozhai.snowflake.xgit.vfs.support.FileRepositoryFactory' />
				</entry>

				<entry key='config'>
					<bean class='com.boluozhai.snowflake.xgit.vfs.support.FileConfigFactory' />
				</entry>

				<entry key='workspace'>
					<bean
						class='com.boluozhai.snowflake.xgit.vfs.support.FileWorkspaceFactory' />
				</entry>

				<entry key='objects'>
					<bean
						class='com.boluozhai.snowflake.xgit.vfs.support.FileObjectBankFactory' />
				</entry>

				<entry key='refs'>
					<bean
						class='com.boluozhai.snowflake.xgit.vfs.support.FileRefsManagerFactory' />
				</entry>

				<entry key='hash_path_mapper'>
					<bean
						class='com.boluozhai.snowflake.xgit.vfs.support.FileHashPathMapperFactory' />
				</entry>

				<entry key='hash_algorithm'>
					<bean
						class='com.boluozhai.snowflake.xgit.vfs.support.FileHashAlgorithmFactory' />
				</entry>

				<entry key='temporary_files'>
					<bean
						class='com.boluozhai.snowflake.xgit.vfs.support.TemporaryFileManagerFactory' />
				</entry>

				<entry key='meta_by_uri'>
					<bean
						class='com.boluozhai.snowflake.xgit.vfs.support.FileUriMetaManagerFactory' />
				</entry>

				<entry key='meta_by_id'>
					<bean
						class='com.boluozhai.snowflake.xgit.vfs.support.FileIdMetaManagerFactory' />
				</entry>

			</map>
		</property>

		<property name="defaultProperties">
			<!-- in Map<String,String> -->
			<map>
				<entry key='xgit.hashalgorithm'>
					<value>SHA-1</value>
				</entry>
				<entry key='xgit.hashpathpattern'>
					<value>xx/xxxx</value>
				</entry>
			</map>
		</property>

		<property name="finalProperties">
			<!-- in Map<String,String> -->
			<map>
				<entry key='xgit.final'>
					<value>xxx</value>
				</entry>
			</map>
		</property>

		<property name="avaliableRepositoryDirectoryNames">
			<list>
				<value>.git</value>
				<value>.xgit</value>
				<value>.snow</value>
				<value>.snowflake</value>
			</list>
		</property>

	</bean>


	<bean id='xgit:driver:http:profile' class='com.boluozhai.snowflake.xgit.support.RepositoryProfile'>

		<property name="components">
			<!-- in Map<String,ComponentBuilderFactory> -->
			<map>
				<entry key='repository'>
					<bean
						class='com.boluozhai.snowflake.xgit.vfs.support.FileRepositoryFactory' />
				</entry>

				<entry key='config'>
					<bean class='com.boluozhai.snowflake.xgit.vfs.support.FileConfigFactory' />
				</entry>

				<entry key='objects'>
					<bean
						class='com.boluozhai.snowflake.xgit.vfs.support.FileObjectBankFactory' />
				</entry>

				<entry key='refs'>
					<bean
						class='com.boluozhai.snowflake.xgit.vfs.support.FileRefsManagerFactory' />
				</entry>
			</map>
		</property>

		<property name="defaultProperties">
			<!-- in Map<String,String> -->
			<map>
				<entry key='xgit.hashalgorithm'>
					<value>SHA-1</value>
				</entry>
			</map>
		</property>

		<property name="finalProperties">
			<!-- in Map<String,String> -->
			<map>
				<entry key='xgit.final'>
					<value>xxx</value>
				</entry>
			</map>
		</property>

		<property name="avaliableRepositoryDirectoryNames">
			<list>
				<value>.git</value>
				<value>.xgit</value>
				<value>.snow</value>
				<value>.snowflake</value>
			</list>
		</property>

	</bean>


</beans>
